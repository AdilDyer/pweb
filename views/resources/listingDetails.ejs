<%-include("../includes/flash.ejs")%>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
    <title>Document</title>
    <style>
      .regis-big-div {
        width: 100%;
        display: flex;
        flex-direction: column;

        align-items: center;
        overflow: hidden;
        color: midnightblue;
      }

      .regis-big-div form {
        line-height: 2rem;
      }
      .regis-big-div form .form-group {
        width: fit-content;
      }
      .regis-logo {
        width: 100%;
        height: 15rem;

        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        flex-direction: column;

        background-color: powderblue;
      }
      .regis-logo-img {
        width: 28rem;
        height: 10rem;
        background: url("https://res.cloudinary.com/ddxv0iwcs/image/upload/v1710502741/emblem_e7gmxn.png");
        background-size: cover;
        background-position: center;
      }
      /* .regis-logo-img img {
  object-fit: contain;
} */

      .input-fields {
        display: flex;
        flex-wrap: wrap;
      }
      .form-group {
        margin-right: 05rem;
        margin-bottom: 1rem;
      }

      .form-group input {
        width: 15rem;
      }

      .down-regis .card {
        background-color: transparent;
        border: 0;
        width: 20rem;
      }
      .down-regis .card p {
        margin: 0;
      }
      /* .down-regis button {
  margin: 3rem;
  padding: 1rem;
  padding-left: 2rem;
  padding-right: 2rem;
  margin-bottom: 10rem;
} */
      .submit-btn {
        display: flex;
        justify-content: center;
      }

      .card-body {
        padding: 0;
      }
      .regis-card-title {
        text-align: start !important;
      }

      .comm-fields {
        display: flex;
        flex-wrap: wrap;
      }
    </style>
  </head>
  <body>
    <div class="regis-big-div">
      <div
        class="left-login"
        style="width: 100%; display: flex; justify-content: center;background-color: white;"
      >
        <div class="pop-out">
          <a href="/"
            ><img
              loading="lazy"
              src="https://res.cloudinary.com/ddxv0iwcs/image/upload/v1710502741/emblem_e7gmxn.png"
              width="250"
              style="padding: 1rem"
              alt=""
          /></a>
        </div>
      </div>

      <div class="down-regis" style="background: linear-gradient(to top left , rgba(255, 107, 107, 0.5) ,rgb(0, 255, 255,0.5));border-radius: 2rem;padding: 2rem;margin-bottom: 3rem;">
        <div class="resources-student-big-div">
          <div class="content-div regis-content-div">
            <div class="content-title container">
              <h2
                style="
                  text-align: center;
                  padding-top: 2rem;
                  padding-bottom: 2rem;
                  margin-bottom: 0;
                "
              >
                <%=listingDetails.companyName%>'s Listing Details
              </h2>
              <hr />
              <h2 style="border-left: solid 4px; padding-left: 5px">
                Company's Information
              </h2>
              <br />
              <form
                action="/admin/updateListing/<%=listingDetails._id%>"
                method="post" enctype="multipart/form-data"
              >
                <div class="input-fields">
                  <div class="form-group">
                    <label for="CompanyName">Company Name
                    <input
                      type="text"
                      class="form-control"
                      name="companyName"
                      value="<%=listingDetails.companyName%>"
                      id="CompanyName"
                      placeholder="Company Name"
                    /></label>
                  </div>

                  <div class="form-group">
                    <label for="NatureofBusiness">Job Location
                    <input
                      type="text"
                      class="form-control"
                      name="jobLocation"
                      value="<%=listingDetails.jobLocation%>"
                      id="NatureofBusiness"
                      placeholder="jobLocation"
                    /></label>
                  </div>
                   <div class="form-group">
                    <label for="NatureofBusiness">Job Type
                    <select name="jobType" id="joType" class="form-control">
                      <option

<%= listingDetails.jobType === "Internship" ? "selected" : "" %>
                      value="Internship">Internship (I)</option>
                      <option
<%= listingDetails.jobType === "Intern FTE" ? "selected" : "" %>
                      value="Intern FTE">Intern FTE (I+F)</option>
                      <option
                      <%= listingDetails.jobType === "FTE" ? "selected" : "" %>
                       value="FTE">FTE (F)</option>
                      <option
                      <%= listingDetails.jobType === "Internship PPO" ? "selected" : "" %>

                      value="Internship PPO">
                        Internship PPO (I+P)
                      </option>
                    </select>
                    </label>
                  </div>


                     <div class="form-group">
                    <label for="ctc" class="form-label">CTC/Stipend
                    <input
                      type="number"
                      class="form-control"
                      name="ctc"
                      value="<%=listingDetails.ctc%>"
                      id="ctc"
                      placeholder="CTC/Stipend"
                    />
                    </label>
                  </div>









<div class="" style="display: flex;">


                   <div class="form-group" style="padding: 1rem;background-color: rgba(45, 153, 255, 0.212);border-radius: 1rem;">

                    <label for="All" class="form-label">All
                    <input
                      type="checkbox"

                      name="forCourse"
                       <%= listingDetails.forCourse.includes('All') ? 'checked' : '' %>
                       value="All"
                      id="All"
                      class="form-check-input"
                      style="height: 20px;width:30px;"

                    />
                    </label>


                    <br>

                    <label for="MTechCS" class="form-label">MTech CS</label>
                    <input
                      type="checkbox"

                      name="forCourse"
                       <%= listingDetails.forCourse.includes('MtechCs') ? 'checked' : '' %>
                       value="MtechCs"
                      id="MtechCs"
                        class="form-check-input"
                      style="height: 20px;width:30px"

                    />

                    <br>



                    <label for="MScCS" class="form-label">MSc CS</label>
                    <input
                      type="checkbox"

                      name="forCourse"
                       <%= listingDetails.forCourse.includes('MScCs') ? 'checked' : '' %>
                       value="MScCs"
                      id="MScCS"
                      style="height: 20px;width:30px"
                        class="form-check-input"

                    />
                    <br>



                    <label for="MScDFIS" class="form-label">MSc DFIS</label>
                    <input
                      type="checkbox"

                      name="forCourse"
                       <%= listingDetails.forCourse.includes('MscDfis') ? 'checked' : '' %>
                       value="MscDfis"
                      id="MScDFIS"
                      style="height: 20px;width:30px"
                        class="form-check-input"

                    />


                    <br>

                    <label for="MScAIDS" class="form-label">MTech ADSAI</label>
                    <input
                      type="checkbox"

                      name="forCourse"
                       <%= listingDetails.forCourse.includes('MtechAdsai') ? 'checked' : '' %>
                       value="MtechAdsai"
                         class="form-check-input"
                      id="MScAIDS"
                      style="height: 20px;width:30px"

                    />

                  </div>
                  <br>








                   <div class="form-group">
                    <label for="jobTitle" class="form-label">Job Titles</label>

                       <% Object.keys(listingDetails.jobTitles).forEach((key, index) => { %>
                <input
                      type="text"
                      class="form-control"
                      name="<%=key%>"
                      value="<%= listingDetails.jobTitles[key] %>"
                      id="jobTitle"
                      placeholder="jobLocation"
                    />
              <% }) %>

                  </div>





                  <div class="form-group ">
                    <label for="newfileupload">Upload new Job Descriptions
</label>

  <% Object.keys(listingDetails.jobDescriptionFiles).forEach((key,
              index)=> { %>
                    <input id="newfileupload" class="form-control " type="file" name="<%= listingDetails.jobDescriptionFiles[key] %>" >
              <% }) %>


                  </div>
                   <div class="form-group" style="margin: 0;">
                    <label for="jobdescriptionFile" class="form-label">Job Descriptions</label>
<br>

                    <% Object.keys(listingDetails.jobDescriptionFiles).forEach((key,
              index)=> { %>
              <a
                href="<%= listingDetails.jobDescriptionFiles[key] %>"

                   target="_blank"
                      class="form-control btn btn-primary"
                style="margin: 0.5rem; width: 5rem"
              >
                JD <%= index + 1 %>
              </a>
              <% }) %>

                  </div>
                  </div>




                  <%
        const date = listingDetails.lastDateToApply;
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are zero-based
        const day = String(date.getDate()).padStart(2, '0');
        const formattedDate = `${year}-${month}-${day}`;
    %>
                  <div class="col-md-4">
                    <label for="lastDate" class="form-label">
                      Last Date To Apply *</label
                    >

                    <input
                      type="date"
                      id="lastDate"

                      name="lastDateToApply"
                      class="form-control"
                      value="<%=formattedDate%>"
                    />
                  </div>


                  <div style="margin-left: 1rem;">
                    <label for="dreamoffer" class="form-label">Is Dream Offer?</label>
                    <input
                      type="checkbox"
                      class="form-control form-check-input"
                      name="isDreamOffer"
                      <%= listingDetails.isDreamOffer ? "checked":""%>
                      id="dreamoffer"
style="height:20px;width:30px"
                      placeholder="Is Dream Offer?"
                    />
                  </div>




                </div>
                <br>
                  <div class="form-group" style="text-align: center;width: 100%;margin-top: 2rem;margin-bottom: 2rem;">
                                         <button class="btn btn-lg btn-primary">Save Changes</button>
</div>

              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      let copyRecruiterEmailBtn = document.getElementById(
        "copyRecruiterEmailBtn"
      );
      let recruiterHeadHrEmail = document.getElementById(
        "recruiterHeadHrEmail"
      );

      copyRecruiterEmailBtn.addEventListener("click", (event) => {
        navigator.clipboard.writeText(recruiterHeadHrEmail.value);
      });
    </script>

    <script>
      // JavaScript for form validation
      (function () {
        "use strict";
        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.querySelectorAll(".needs-validation");
        // Loop over them and prevent submission
        Array.prototype.slice.call(forms).forEach(function (form) {
          form.addEventListener(
            "submit",
            function (event) {
              if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
              }
              form.classList.add("was-validated");
            },
            false
          );
        });
      })();
    </script>

    <!-- <script>
      // Function to disable all input fields
      let disableAllCourseInputs = () => {
        let allInputs = document.querySelectorAll(".forcheck input");
        allInputs.forEach((input) => {
          input.required = false;
          input.style.display = "none";
        });
      };

      // Call disableAllCourseInputs when the DOM is loaded
      document.addEventListener("DOMContentLoaded", disableAllCourseInputs);

      // Function to set required attribute based on checkbox state
      let setRequired = (classname) => {
        let rowInputs = document.querySelectorAll(".for" + classname);
        rowInputs.forEach((inputRow) => {
          let inputs = inputRow.querySelectorAll("input");
          inputs.forEach((input) => {
            if (input.required == false) {
              input.required = true;
              input.style.display = "inline";
            } else {
              input.required = false;
              input.style.display = "none";
            }
          });
        });
      };

      // Get all checkboxes with class "courseInputCheck"
      let checks = document.querySelectorAll(".courseInputCheck");

      // Add event listeners to checkboxes
      checks.forEach((check) => {
        check.addEventListener("change", (event) => {
          if (event.target) {
            if (check.name == "checkmtechcs") {
              setRequired("checkmtechcs");
            } else if (check.name == "checkmsccs") {
              setRequired("checkmsccs");
            } else if (check.name == "checkmscdfis") {
              setRequired("checkmscdfis");
            } else if (check.name == "checkmtechadsai") {
              setRequired("checkmtechadsai");
            }
          }
        });
      });
    </script> -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
